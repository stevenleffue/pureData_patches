#N canvas -887 -1397 1303 1309 12;
#N canvas 642 163 417 426 samples 1;
#N canvas 0 0 450 300 (subpatch) 0;
#X array sample1 90645 float 0;
#X coords 0 1.02 90644 -1.02 200 130 1;
#X restore 116 45 graph;
#X text 125 352 ------ 4 seconds ------;
#N canvas 0 0 450 300 (subpatch) 0;
#X array sample2 176403 float 0;
#X coords 0 1.02 176403 -1.02 200 130 1;
#X restore 116 210 graph;
#X restore 517 579 pd samples;
#X text 781 463 sample number;
#X obj 562 129 poly 8 1;
#X obj 647 275 route 1 2 3 4 5 6 7 8;
#X obj 562 154 swap;
#X obj 562 201 route 0;
#X obj 562 178 pack;
#X obj 608 226 unpack;
#X obj 562 226 pack;
#X text 932 416 amplitude;
#X text 931 440 pitch;
#X text 850 349 ARGUMENTS FOR:;
#X text 783 391 pitch;
#X text 783 415 amplitude;
#X text 783 439 duration;
#X text 40 12 POLY SAMPLER \, VERSION 2 FOR SEPARATE NOTE-ON/OFF MESSAGES;
#X obj 633 56 r onoff;
#X text 931 373 ON/OFF TRANSITIONS:;
#X text 784 372 ENTIRE NOTES:;
#X text 931 395 tag;
#X text 781 490 sample onset;
#X text 781 516 rise time;
#X text 782 540 decay time;
#X text 928 465 (same other 4);
#X obj 816 142 f;
#X obj 852 142 + 1;
#X obj 826 168 mod 1e+06;
#X obj 897 48 r note;
#X text 958 884 updated for Pd version 0.37;
#X obj 870 111 t b f;
#X obj 911 279 s onoff;
#X obj 865 224 pipe;
#X obj 865 247 pack;
#X msg 1158 96 \; onoff 1 90 60 1 0 0 100;
#X msg 1378 96 \; onoff 1 0;
#X msg 1159 265 \; note 51 90 1000 1 0 0 100;
#X text 59 42 Here is a variation on the polyphonic sampler \, which can take separate messages to start and stop notes (so that you can attach it to a MIDI keyboard \, for example.) "Note" messages act as before \, but in an intermediate step they are split onto note-on and note-off messages \, sent to "onoff". You can alternatively send messages straight to onoff if you don't know the duration in advance.;
#X text 59 149 Messages to "onoff" require a tag \, which is a number shared between the note-on and note-off message so that we can track down the voice to turn it off. If you're using MIDI input \, you can just re-use the pitch as a tag., f 60;
#X text 1157 76 separate messages for not on and off:;
#X text 1156 246 single messages to do both as before:;
#X text 58 218 Messages to "onoff" whose amplitude is zero are note-off messages (the other parameters of note-off messages are ignored). The "sampvoice2" abstraction is a modification of "sampvoice" which looks at the amplitude field to decide whether to begin or end a note., f 60;
#X text 58 298 To convert "note" messages to pairs of "onoff" messages \, first a counter generates a tag. The the "pipe" object delays a copy of the tag \, which the following "pack" object converts into a note-off message (a pair of numbers \, the tag and a zero.);
#X text 58 376 Under "r onoff" \, the poly object allocates a voice number \, putting it out paired with velocity. After swapping the two and packing them into a single message \, the amplitude is checked against zero by the "route 0" object \; if zero \, the "pack" confects a 2-argument message (voice number and zero). Otherwise \, the "unpack" retrieves the nonzero amplitude for a note-on message \, to which we add all the other parameters and route to the appropriate voice.;
#X obj 633 81 unpack f f f f f f f;
#X obj 647 250 pack f f f f f f f;
#X obj 897 74 unpack f f f f f f f;
#X obj 911 224 pack f f f f f f f;
#N canvas 282 191 708 551 recorder 0;
#X obj 152 363 adc~ 1;
#X obj 152 391 hip~ 5;
#X obj 221 421 line~;
#X obj 152 420 *~;
#X msg 221 393 1;
#X obj 280 358 del 3990;
#X msg 257 393 0 10;
#X obj 152 471 tabwrite~ sample1;
#X obj 66 296 makefilename sample%1;
#X msg 66 325 set \$1 \, bang;
#X msg 324 329 stop;
#X msg 280 329 bang;
#X obj 402 233 openpanel;
#X msg 402 205 bang;
#X obj 242 168 route record stop reload browse;
#X msg 402 260 read \$1 sample1;
#X obj 402 287 soundfiler;
#X text 440 205 <= browse for samples;
#X text 228 21 record \, etc.;
#X msg 242 48 record 1;
#X msg 256 92 stop;
#X msg 249 70 record 2;
#X msg 262 114 reload;
#X msg 267 136 browse;
#X connect 0 0 1 0;
#X connect 1 0 3 0;
#X connect 2 0 3 1;
#X connect 3 0 7 0;
#X connect 4 0 2 0;
#X connect 5 0 6 0;
#X connect 6 0 2 0;
#X connect 8 0 9 0;
#X connect 9 0 7 0;
#X connect 10 0 5 0;
#X connect 11 0 5 0;
#X connect 12 0 15 0;
#X connect 13 0 12 0;
#X connect 14 0 8 0;
#X connect 14 0 11 0;
#X connect 14 0 4 0;
#X connect 14 1 6 0;
#X connect 14 1 10 0;
#X connect 14 3 13 0;
#X connect 15 0 16 0;
#X connect 19 0 14 0;
#X connect 20 0 14 0;
#X connect 21 0 14 0;
#X connect 22 0 14 0;
#X connect 23 0 14 0;
#X restore 517 603 pd recorder;
#X obj 751 812 loadbang;
#X obj 751 940 soundfiler;
#X msg 751 841 read pittsnap.wav sample1;
#X floatatom 58 694 5 0 0 0 - - - 0;
#X msg 189 768 addsemi;
#X msg 155 767 set;
#X msg 258 768 add2 note;
#X msg 331 768 add2 \$1;
#X obj 63 930 metro;
#X obj 63 954 random 100;
#X obj 142 898 * 2;
#X obj 63 909 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000 0 1;
#X floatatom 160 874 5 0 0 0 - - - 0;
#X obj 333 908 phasor~;
#X obj 333 935 snapshot~;
#X floatatom 333 880 5 0 0 0 - - - 0;
#X floatatom 333 959 5 0 0 0 - - - 0;
#X obj 405 907 metro;
#X obj 404 882 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000 #000000 0 1;
#X floatatom 437 883 5 0 0 0 - - - 0;
#X text 749 1166 next try a phasor running a table of values 0 - 127;
#X obj 556 547 dac~;
#X obj 556 511 *~;
#X floatatom 602 512 5 0 0 0 - - - 0;
#X obj 602 537 / 100;
#X floatatom 128 820 5 0 0 0 - - - 0;
#X msg 751 883 read bloop.wav sample1;
#X msg 751 912 read drop1.wav sample1;
#X msg 843 992 read Inharmonious.wav sample1;
#X msg 863 1052 read -resize Jangly.wav sample1;
#X msg 853 1022 read -resize BarelyDiscernible.wav sample1;
#X msg 873 1082 read -resize JanglyWind.wav sample1;
#X msg 883 1112 read -resize Murky.wav sample1;
#X msg 285 819 \; note 120 90 10293.5 1 0 0 1000;
#X obj 232 721 t b f f b b b;
#X obj 428 716 f;
#X floatatom 461 690 5 0 0 0 - - - 0;
#X obj 428 690 b;
#X obj 233 682 int;
#X obj 695 1066 random 5;
#X obj 695 1097 route 0 1 2 3 4 5;
#X obj 696 1146 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 721 1144 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 752 1145 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 777 1143 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 808 1146 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 833 1144 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 333 982 * 127;
#X msg 393 768 add2 90 \$1 1 0 0 1000;
#X obj 523 700 *;
#X obj 548 672 tgl 19 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000 0 1;
#X obj 618 712 - 1;
#X obj 618 736 abs;
#X obj 600 760 *;
#X floatatom 600 672 5 0 0 0 - - - 0;
#X obj 523 725 route 0;
#X obj 600 785 route 0;
#X msg 1159 138 \; onoff 2 90 48 1 0 0 1000;
#X obj 1256 439 notein;
#X floatatom 1256 483 5 0 0 0 - - - 0;
#X floatatom 1297 483 5 0 0 0 - - - 0;
#X msg 1256 549 bang;
#X obj 1256 620 + 1;
#X obj 1256 574 float;
#X floatatom 1256 645 4 0 0 0 - - - 0;
#X floatatom 1256 725 5 0 0 0 - - - 0;
#X floatatom 1302 726 5 0 0 0 - - - 0;
#X obj 1256 702 moses 8;
#X obj 1302 751 t b b;
#X msg 1302 779 set 0;
#X msg 1358 780 0;
#X floatatom 1256 848 5 0 0 0 - - - 0;
#X obj 1256 676 mod 9;
#X obj 1256 525 t b f;
#X msg 1546 438 stop;
#X msg 1535 412 clear;
#X obj 1470 500 pack f f f;
#X msg 1383 386 60 \$1;
#X msg 1430 386 62 \$1;
#X msg 1477 386 65 \$1;
#X msg 1525 386 69 \$1;
#X text 1580 413 clear memory;
#X text 1585 438 flush hanging note on messages;
#X obj 1525 360 tgl 19 0 empty empty empty 17 7 0 10 #dfdfdf #000000 #000000 0 64;
#X text 1568 385 <-- emulating note on/off messages;
#X text 1547 470 <-- first argument \, number of voices second argument selects voice stealing, f 43;
#X obj 1383 360 tgl 19 0 empty empty empty 17 7 0 10 #dfdfdf #000000 #000000 0 64;
#X obj 1430 360 tgl 19 0 empty empty empty 17 7 0 10 #dfdfdf #000000 #000000 0 64;
#X obj 1477 360 tgl 19 0 empty empty empty 17 7 0 10 #dfdfdf #000000 #000000 0 64;
#X obj 1382 465 pack;
#X msg 1379 138 \; onoff 2 0 48 1 0 0 1000;
#X msg 1511 717 addsemi;
#X msg 1477 716 set;
#X msg 1670 717 add2 \$1;
#X msg 1580 717 add2 onoff;
#X obj 1470 537 unpack f f f;
#X floatatom 1447 574 5 0 0 0 - - - 0;
#X floatatom 1497 574 5 0 0 0 - - - 0;
#X floatatom 1550 576 5 0 0 0 - - - 0;
#X msg 1477 826 \; onoff 5 0 35 1 0 0 0;
#X msg 1732 717 add2 \$1;
#X msg 1798 717 add2 \$1;
#X obj 1509 611 f;
#X obj 1591 617 f;
#X obj 1681 796 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 1740 786 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 1823 768 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X obj 1466 653 t f b b b;
#X obj 1642 600 min 100;
#X obj 1477 470 poly 8;
#X floatatom 1869 667 5 0 0 0 - - - 0;
#X obj 1818 653 f;
#X msg 1866 717 add2 1 0 0 \$1;
#X msg 833 962 read -resize AmbientWaterfall.wav sample1;
#X obj 1848 795 t b b b;
#X obj 556 302 sampvoice3;
#X obj 556 325 sampvoice3;
#X obj 556 349 sampvoice3;
#X obj 556 373 sampvoice3;
#X obj 556 398 sampvoice3;
#X obj 556 420 sampvoice3;
#X obj 556 443 sampvoice3;
#X obj 556 477 sampvoice3;
#X obj 625 811 t b f;
#X obj 181 1065 *;
#X floatatom 200 963 5 0 0 0 - - - 0;
#X obj 200 986 / 100;
#X obj 200 1010 * 127;
#X floatatom 200 1034 5 0 0 0 - - - 0;
#X obj 181 1089 +;
#X floatatom 292 1049 5 0 0 0 - - - 0;
#X obj 112 992 +;
#X floatatom 129 844 5 0 0 0 - - - 0;
#X text 82 819 range scale;
#X obj 459 1041 bng 19 250 50 0 empty empty empty 0 -10 0 12 #fcfcfc #000000 #000000;
#X connect 2 0 4 0;
#X connect 2 2 4 1;
#X connect 3 0 163 0;
#X connect 3 1 164 0;
#X connect 3 2 165 0;
#X connect 3 3 166 0;
#X connect 3 4 167 0;
#X connect 3 5 168 0;
#X connect 3 6 169 0;
#X connect 3 7 170 0;
#X connect 4 0 6 0;
#X connect 4 1 6 1;
#X connect 5 0 8 0;
#X connect 5 1 7 0;
#X connect 6 0 5 0;
#X connect 7 1 44 0;
#X connect 8 0 3 0;
#X connect 16 0 43 0;
#X connect 24 0 25 0;
#X connect 25 0 26 0;
#X connect 26 0 24 1;
#X connect 26 0 31 0;
#X connect 26 0 46 0;
#X connect 27 0 45 0;
#X connect 29 0 24 0;
#X connect 29 1 46 2;
#X connect 31 0 32 0;
#X connect 32 0 30 0;
#X connect 43 0 2 0;
#X connect 43 1 2 1;
#X connect 43 1 44 1;
#X connect 43 2 44 2;
#X connect 43 3 44 3;
#X connect 43 4 44 4;
#X connect 43 5 44 5;
#X connect 43 6 44 6;
#X connect 44 0 3 0;
#X connect 45 0 29 0;
#X connect 45 1 46 1;
#X connect 45 2 31 1;
#X connect 45 3 46 3;
#X connect 45 4 46 4;
#X connect 45 5 46 5;
#X connect 45 6 46 6;
#X connect 46 0 30 0;
#X connect 48 0 50 0;
#X connect 50 0 49 0;
#X connect 51 0 86 0;
#X connect 52 0 81 0;
#X connect 53 0 81 0;
#X connect 54 0 81 0;
#X connect 55 0 81 0;
#X connect 56 0 57 0;
#X connect 57 0 58 0;
#X connect 57 0 179 0;
#X connect 58 0 56 1;
#X connect 58 0 97 0;
#X connect 59 0 56 0;
#X connect 60 0 58 1;
#X connect 61 0 62 0;
#X connect 62 0 64 0;
#X connect 63 0 61 0;
#X connect 64 0 95 0;
#X connect 65 0 62 0;
#X connect 66 0 65 0;
#X connect 67 0 65 1;
#X connect 70 0 69 0;
#X connect 70 0 69 1;
#X connect 71 0 72 0;
#X connect 72 0 70 1;
#X connect 73 0 57 1;
#X connect 74 0 49 0;
#X connect 75 0 49 0;
#X connect 76 0 49 0;
#X connect 77 0 49 0;
#X connect 78 0 49 0;
#X connect 79 0 49 0;
#X connect 80 0 49 0;
#X connect 82 0 81 0;
#X connect 82 1 85 0;
#X connect 82 2 55 0;
#X connect 82 3 54 0;
#X connect 82 4 52 0;
#X connect 82 5 53 0;
#X connect 83 0 96 0;
#X connect 84 0 83 1;
#X connect 85 0 83 0;
#X connect 86 0 82 0;
#X connect 87 0 88 0;
#X connect 88 0 89 0;
#X connect 88 1 90 0;
#X connect 88 2 91 0;
#X connect 88 3 92 0;
#X connect 88 4 93 0;
#X connect 88 5 94 0;
#X connect 89 0 161 0;
#X connect 90 0 78 0;
#X connect 91 0 77 0;
#X connect 92 0 79 0;
#X connect 93 0 80 0;
#X connect 95 0 51 0;
#X connect 96 0 81 0;
#X connect 97 0 103 0;
#X connect 98 0 97 1;
#X connect 98 0 99 0;
#X connect 99 0 100 0;
#X connect 100 0 101 1;
#X connect 101 0 104 0;
#X connect 102 0 101 0;
#X connect 103 1 84 0;
#X connect 104 1 171 0;
#X connect 106 0 107 0;
#X connect 106 1 108 0;
#X connect 107 0 137 0;
#X connect 108 0 137 1;
#X connect 109 0 111 0;
#X connect 110 0 111 1;
#X connect 110 0 112 0;
#X connect 111 0 110 0;
#X connect 112 0 120 0;
#X connect 113 0 119 0;
#X connect 114 0 116 0;
#X connect 114 0 119 0;
#X connect 115 0 113 0;
#X connect 115 1 114 0;
#X connect 116 0 117 0;
#X connect 116 1 118 0;
#X connect 117 0 112 0;
#X connect 118 0 111 1;
#X connect 120 0 115 0;
#X connect 122 0 157 0;
#X connect 123 0 157 0;
#X connect 124 0 143 0;
#X connect 125 0 157 0;
#X connect 126 0 157 0;
#X connect 127 0 157 0;
#X connect 128 0 157 0;
#X connect 131 0 128 0;
#X connect 134 0 125 0;
#X connect 135 0 126 0;
#X connect 136 0 127 0;
#X connect 137 0 157 0;
#X connect 139 0 147 0;
#X connect 140 0 147 0;
#X connect 141 0 147 0;
#X connect 141 0 152 0;
#X connect 142 0 147 0;
#X connect 143 0 144 0;
#X connect 143 1 145 0;
#X connect 143 2 146 0;
#X connect 144 0 155 0;
#X connect 145 0 150 1;
#X connect 146 0 156 0;
#X connect 148 0 147 0;
#X connect 148 0 153 0;
#X connect 149 0 147 0;
#X connect 149 0 154 0;
#X connect 150 0 149 0;
#X connect 151 0 148 0;
#X connect 152 0 151 0;
#X connect 153 0 150 0;
#X connect 154 0 162 0;
#X connect 155 0 141 0;
#X connect 155 1 142 0;
#X connect 155 2 139 0;
#X connect 155 3 140 0;
#X connect 156 0 151 1;
#X connect 157 0 124 0;
#X connect 157 1 124 1;
#X connect 157 2 124 2;
#X connect 158 0 159 1;
#X connect 159 0 160 0;
#X connect 160 0 147 0;
#X connect 161 0 49 0;
#X connect 162 1 147 0;
#X connect 162 2 159 0;
#X connect 163 0 70 0;
#X connect 164 0 70 0;
#X connect 165 0 70 0;
#X connect 166 0 70 0;
#X connect 167 0 70 0;
#X connect 168 0 70 0;
#X connect 169 0 70 0;
#X connect 170 0 70 0;
#X connect 171 0 83 0;
#X connect 171 1 84 0;
#X connect 172 0 177 0;
#X connect 173 0 174 0;
#X connect 174 0 175 0;
#X connect 175 0 176 0;
#X connect 176 0 172 1;
#X connect 178 0 177 1;
#X connect 179 0 51 0;
#X connect 179 0 182 0;
#X connect 180 0 179 1;
#X connect 182 0 87 0;
